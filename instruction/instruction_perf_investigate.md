
# パフォーマンス調査用テンプレート（重い処理の原因特定）

このファイルは、処理が重い・ボタン押下後の待ち時間が長い場合に、
ChatGPT が「原因調査 → 仮説 → 改善候補」の順で進めるためのルールです。

## 基本方針

- いきなり大規模なリファクタをしない
- まず「どこが遅いのか」を特定する
- SpreadsheetApp の呼び出し回数・位置を洗い出す
- ログ計測（new Date() + Logger.log）の案を優先する
- 調査フェーズと修正フェーズを明確に分ける

## ユーザーが依頼するときのテンプレ

ユーザーは、重いと感じる処理やボタン押下時のエントリーポイントを指定して、次のように依頼します。

---

PERF: 次の処理が重いので、まず原因調査だけお願いします。

現象：
- （例）ボタン X を押した後、毎回 5 秒以上待たされる

対象：
- （例）`onClickRunDraft()` 関数 から始まる処理

お願いしたいこと：
1. 対象関数から呼ばれる処理の「呼び出し順序」を簡潔に書き出す
2. SpreadsheetApp を呼んでいる箇所だけ抽出して一覧にする
3. ボトルネック候補を3つ以内で挙げる（仮説ベースでOK）
4. ログ計測案（どこに Logger.log(new Date()) を入れるべきか）を提案する

※ この段階ではコードを書き換えないでください。

---

## ChatGPT の返答フォーマット

1. 呼び出し順序の概要
2. SpreadsheetApp 呼び出し箇所一覧
3. ボトルネック候補（仮説）
4. ログ計測案

ユーザーがログ結果を報告してきたら、その情報を元に、
必要に応じて部分的な改善（リファクタ or 最適化）を提案します。
