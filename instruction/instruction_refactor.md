# リファクタリング依頼用テンプレート

このファイルは、GASコードをリファクタリングするときに ChatGPT が従うべきルールと、
ユーザーが依頼するときのフォーマットを定義します。

## リファクタリングの前提

- 外部仕様（ユーザーから見える挙動）は絶対に変えない
- 挙動が変わる可能性のある修正は「改修」であり、このファイルの対象外
- 目的は以下のいずれか：
  - 可読性を上げる
  - 関数・責務の分割
  - 重複の削減
  - SpreadsheetApp 呼び出しの整理
  - 将来的な保守・追加開発のしやすさの向上

## ChatGPT が守るべき方針

1. いきなり巨大なリライトを行わない  
2. まず「問題点の要約」と「改善方針」をテキストで示し、ユーザーが違和感ないか確認できるようにする  
3. コードを提示するときは、変更箇所が分かるようにブロック単位で示す  
4. SpreadsheetApp の呼び出しは減らす方向で検討するが、挙動を変えない範囲に留める  
5. 影響範囲が広くなりそうな場合は、必ず事前に相談する

## ユーザーが依頼するときのテンプレ

ユーザーは、リファクタしたいコードブロックを指定して、次のように依頼します。

---

「REF:」から始めることで、このテンプレに沿ったリファクタを依頼する意図を示します。

### 例

REF: 次の関数をリファクタしてください。

目的：
- 責務を整理して読みやすくしたい
- SpreadsheetApp の呼び出しを整理したい

対象コード：
```js
// ここに対象の関数やブロックを書く

---

## ChatGPT の返答フォーマット
ChatGPT は、基本的に次の構成で回答してください：
1. 問題点の要約
2. 改善方針（なぜそうするか）
3. 修正後のコード
4. 変更の影響範囲の説明